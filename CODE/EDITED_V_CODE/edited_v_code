Edited versions of the code.
